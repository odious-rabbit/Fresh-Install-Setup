
//

//
// Copyright (C) 2024-2025 celenity
//
// This file is part of Phoenix.
//
// Phoenix is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.
//
// Phoenix is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along with Phoenix. If not, see https://www.gnu.org/licenses/.
//

// This file contains preferences shared across Phoenix 'Extended' configs.

/* INDEX 

001: FINGERPRINTING PROTECTION
002: WEBRTC
003: ATTACK SURFACE REDUCTION
004: MISC. PRIVACY + SECURITY (ANDROID ONLY)
005: MISC. PRIVACY

*/

/* KEY

Unspecified = This preference should be set EVERYWHERE

[LINUX-ONLY] = This preference should ONLY be set for GNU/Linux
[LINUX-NON-FLATPAK-ONLY] = This preference should ONLY be set for GNU/Linux (non-Flatpak)

[NO-ANDROID] = This preference should be set everywhere, EXCEPT for Android
[NO-FLATPAK-LINUX] = This preference should be set everywhere, EXCEPT for GNU/Linux (Flatpak)
[NO-MAIL] = This preference should be set everywhere, EXCEPT for Thunderbird (Useful for ex. Dove)
[NO-OSX] = This preference should be set everywhere, EXCEPT for macOS
[NO-INTEL-OSX] = This preference should be set everywhere, EXCEPT for macOS on Intel
[NO-SILICON-OSX] = This preference should be set everywhere, EXCEPT for macOS on Apple Silicon
[NO-WINDOWS] = This preference should be set everywhere, EXCEPT for Windows

*/

/// Add custom branding at `about:support`
lockPref("app.support.vendor", "Phoenix - Extended: 2025.11.27.1"); // [NO-MAIL] [HIDDEN]

/// Add custom branding under `Firefox Updates` at `about:preferences#general` [NO-ANDROID]
// This will unfortunately only display if the version of Firefox you're using is repackaged (ex. Flatpaks/Linux distros) [NO-ANDROID]
lockPref("distribution.about", "Phoenix - Extended for Mozilla Firefox: 2025.11.27.1 ðŸ’œ"); // [NO-ANDROID] [NO-MAIL] [HIDDEN]

/*** 001 FINGERPRINTING PROTECTION ***/

/// Enable dynamic rounding of content dimensions [NO-ANDROID]
// https://bugzilla.mozilla.org/show_bug.cgi?id=1407366 [NO-ANDROID]
defaultPref("privacy.resistFingerprinting.letterboxing", true); // [NO-ANDROID]

/// Further harden FPP...
// As explained here: https://codeberg.org/celenity/Phoenix/wiki/Extended#fingerprinting
// Compared to standard, this just removes '-JSDateTimeUTC' - meaning timezone is spoofed to UTC-0
defaultPref("privacy.fingerprintingProtection.overrides", "+AllTargets,-CanvasExtractionBeforeUserInputIsBlocked,-CSSPrefersColorScheme,-FrameRate"); // [NO-ANDROID] [NO-MAIL]
defaultPref("browser.phoenix.status.extended", "001");

/*** 002 WEBRTC ***/
// This will likely break WebRTC...

/// Always exclude local IP addresses, even in trusted scenarios
defaultPref("media.peerconnection.ice.no_host", true);

/// Force a single candidate for ICE generation
defaultPref("media.peerconnection.ice.default_address_only", true);

/// Only use TURN servers/relays
// No P2P
// https://gitlab.torproject.org/tpo/applications/mullvad-browser/-/issues/40#note_2884663
defaultPref("media.peerconnection.ice.relay_only", true);

defaultPref("browser.phoenix.status.extended", "002");

/*** 003 ATTACK SURFACE REDUCTION ***/

/// Disable WebAssembly (WASM)
// https://spectrum.ieee.org/more-worries-over-the-security-of-web-assembly
defaultPref("javascript.options.wasm", false);

defaultPref("browser.phoenix.status.extended", "003");

/*** 004 MISC. PRIVACY + SECURITY ***/


defaultPref("browser.phoenix.status.extended", "004");

/*** 005 MISC. PRIVACY ***/

/// Only send cross-origin referers if hosts match
// https://wiki.mozilla.org/Security/Referrer
defaultPref("network.http.referer.XOriginPolicy", 2);

defaultPref("browser.phoenix.status.extended", "005");

lockPref("browser.phoenix.status.extended", "successfully applied :D");
//

//
// Copyright (C) 2024-2025 celenity
//
// This file is part of Phoenix.
//
// Phoenix is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.
//
// Phoenix is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along with Phoenix. If not, see https://www.gnu.org/licenses/.
//

// This is for shared preferences across Phoenix's 'specialized' configs...

// Do not apply these settings on profiles you actually plan to browse on or actively use...

// Goal here is to make these profile as light-weight & minimal as possible.

/* INDEX 

001: UI
002: DEBLOAT
003: PRIVACY + SECURITY
004: PRIVACY
005: SECURITY
006: MISC.

*/

/*** 001 UI ***/

/// Disable bookmark edit dialog
defaultPref("browser.bookmarks.editDialog.maxRecentFolders", 0); // Don't try to display any recently selected folders in it either...
defaultPref("browser.bookmarks.editDialog.showForNewBookmarks", false);

/// Disable the bookmarks toolbar
clearPref("browser.toolbars.bookmarks.visibility"); // Temporary, to ensure our new setting below takes effect, due to how we previously handled this via policies
defaultPref("browser.bookmarks.defaultLocation", "menu");
defaultPref("browser.toolbars.bookmarks.visibility", "never");

/// Disable button to switch search engines
defaultPref("browser.urlbar.searchModeSwitcher.featureGate", false); // [HIDDEN]

/// Disable the "Close duplicate tabs" context menu item
defaultPref("browser.tabs.context.close-duplicate.enabled", false);

/// Disable the download panel
defaultPref("browser.download.alwaysOpenPanel", false);
defaultPref("browser.download.autohideButton", true);
defaultPref("browser.download.panel.shown", true);

/// Disable the fire button in Private Browsing Windows
defaultPref("browser.privatebrowsing.resetPBM.enabled", false);

/// Disable the "Forget" button
defaultPref("privacy.panicButton.enabled", false);

/// Disable local keyword shortcuts
defaultPref("browser.urlbar.searchRestrictKeywords.featureGate", false); // [HIDDEN]

/// Disable the menu bar
// Using `ui.nativeMenubar` here is clever, it tricks the browser into thinking we're using ex. OS X - where the built-in menu bar isn't supported (since OS X handles it natively)
// So, on environments outside of OS X, this effectively disables the menu bar
defaultPref("ui.nativeMenubar", 1); // [HIDDEN] 
defaultPref("widget.gtk.global-menu.enabled", false); // [DEFAULT] Linux (GTK)
defaultPref("widget.gtk.global-menu.wayland.enabled", false); // [DEFAULT] Linux (GTK)

/// Disable the new Sidebar
// Note: This is technically required for vertical tabs (which we enable below), so we partially enable it - but we hide it/remove it from visibility
lockPref("browser.toolbarbuttons.introduced.sidebar-button", true); // Ensure the sidebar icon isn't pinned to the URL bar on first run
defaultPref("sidebar.expandOnHover", false);
defaultPref("sidebar.main.tools", "");
defaultPref("sidebar.revamp", true);

/// Disable the new URL bar/search UI by default
defaultPref("browser.urlbar.scotchBonnet.enableOverride", false);

/// Disable notification if default search engine is removed
defaultPref("browser.search.removeEngineInfobar.enabled", false);

/// Disable profiles UI
defaultPref("browser.profiles.enabled", false);

/// Disable the "Saved to bookmarks" confirmation hint
// https://searchfox.org/firefox-main/rev/4dad4a9a/browser/base/content/browser-places.js#357
defaultPref("browser.bookmarks.editDialog.confirmationHintShowCount", 3); // [HIDDEN]

/// Disable the "Share URL" menu item
defaultPref("browser.menu.share_url.allow", false); // [HIDDEN]

/// Disable tab detach
defaultPref("browser.tabs.allowTabDetach", false);

/// Disable Tab Groups
// https://www.ghacks.net/2024/12/03/how-to-enable-tab-groups-in-firefox/
defaultPref("browser.tabs.groups.enabled", false);

/// Disable tab notes
// https://searchfox.org/firefox-main/rev/ac83682a/browser/components/tabbrowser/content/tabbrowser.js#9694
defaultPref("browser.tabs.notes.enabled", false); // [DEFAULT - non-Nightly]

/// Disable tab "split view"
defaultPref("browser.tabs.splitView.enabled", false); // [DEFAULT]

/// Disable tooltips
defaultPref("browser.chrome.toolbar_tips", false);

/// Disable UI for using a different search engine in normal vs. private Windows
defaultPref("browser.search.separatePrivateDefault.ui.enabled", false);

/// Disable the "Unload Tab" context menu item
defaultPref("browser.tabs.unloadTabInContextMenu", false);

/// Disable URL Bar suggestions
defaultPref("browser.search.separatePrivateDefault.urlbarResult.enabled", false); // [DEFAULT]
defaultPref("browser.translations.quickAction.enabled", false); // [NIGHTLY]
defaultPref("browser.urlbar.accessibility.tabToSearch.announceResults", false);
defaultPref("browser.urlbar.addons.featureGate", false);
defaultPref("browser.urlbar.allowSearchSuggestionsForSimpleOrigins", false);
defaultPref("browser.urlbar.clipboard.featureGate", false);
defaultPref("browser.urlbar.closeOtherPanelsOnOpen", false); // [HIDDEN]
defaultPref("browser.urlbar.contextualSearch.enabled", false);
defaultPref("browser.urlbar.experimental.hideHeuristic", true); // [HIDDEN]
defaultPref("browser.urlbar.flightStatus.featureGate", false);
defaultPref("browser.urlbar.importantDates.featureGate", false);
defaultPref("browser.urlbar.market.featureGate", false);
defaultPref("browser.urlbar.maxHistoricalSearchSuggestions", 0);
defaultPref("browser.urlbar.maxRichResults", 0);
defaultPref("browser.urlbar.mdn.featureGate", false);
defaultPref("browser.urlbar.merino.endpointURL", "");
defaultPref("browser.urlbar.merino.ohttpConfigURL", "");
defaultPref("browser.urlbar.merino.ohttpRelayURL", "");
defaultPref("browser.urlbar.merino.providers", "");
defaultPref("browser.urlbar.quickactions.enabled", false); // [HIDDEN]
defaultPref("browser.urlbar.quickactions.showPrefs", false); // [HIDDEN] [DEFAULT]
defaultPref("browser.urlbar.recentsearches.featureGate", false);
defaultPref("browser.urlbar.resultMenu.keyboardAccessible", false);
defaultPref("browser.urlbar.richSuggestions.featureGate", false);
defaultPref("browser.urlbar.richSuggestions.tail", false);
defaultPref("browser.urlbar.rustIngestIntervalSeconds", -1); // [HIDDEN]
defaultPref("browser.urlbar.secondaryActions.featureGate", false); // [HIDDEN]
defaultPref("browser.urlbar.sports.featureGate", false); // [NIGHTLY]
defaultPref("browser.urlbar.suggest.bookmark", false);
defaultPref("browser.urlbar.suggest.calculator", false);
defaultPref("browser.urlbar.suggest.importantDates", false);
defaultPref("browser.urlbar.suggest.openpage", false);
defaultPref("browser.urlbar.suggest.remotetab", false);
defaultPref("browser.urlbar.suggest.sports", false); // [NIGHTLY]
defaultPref("browser.urlbar.suggest.topsites", false);
defaultPref("browser.urlbar.trending.featureGate", false);
defaultPref("browser.urlbar.unitConversion.enabled", false);
defaultPref("browser.urlbar.weather.featureGate", false); // [DEFAULT]
defaultPref("browser.urlbar.wikipedia.featureGate", false); // [DEFAULT]
defaultPref("keyword.enabled", false);

/// Disable visual search
defaultPref("browser.search.visualSearch.featureGate", false);

/// Disable Web Compatibility interventions
defaultPref("extensions.pictureinpicture.enable_picture_in_picture_overrides", false); // [HIDDEN]
defaultPref("extensions.webcompat.enable_interventions", false);  // [HIDDEN]
defaultPref("extensions.webcompat.perform_injections", false); // [HIDDEN]
defaultPref("extensions.webcompat.perform_ua_overrides", false); // [HIDDEN]

/// Do not automatically add UI widgets
defaultPref("browser.uiCustomization.autoAdd", false); // [HIDDEN]

/// Do not display separate tabs
defaultPref("browser.tabs.tabMinWidth", 2000);

/// Enable `Compact` mode
defaultPref("browser.uidensity", 1);

/// Enable the use of cursor (arrow) keys to navigate webpages
defaultPref("accessibility.browsewithcaret", true);

/// Enable vertical tabs
defaultPref("sidebar.verticalTabs", true); // [DEFAULT]

/// Hide "Mobile Bookmarks"
defaultPref("browser.toolbars.bookmarks.showMobileBookmarks", false); // [HIDDEN]

/// Hide "Other Bookmarks"
defaultPref("browser.toolbars.bookmarks.showOtherBookmarks", false);

/// Hide the search bar at `Customize toolbar...`
defaultPref("browser.search.widget.inNavBar", false); // [HIDDEN] [DEFAULT]
defaultPref("browser.search.widget.new", false); // [DEFAULT]

/// Hide tab "x" button
defaultPref("browser.tabs.tabClipWidth", 999999999);

/// Hide UI elements
defaultPref("browser.uiCustomization.horizontalTabsBackup", '{"placements":{"widget-overflow-fixed-list":[],"unified-extensions-area":[],"nav-bar":["sidebar-button","vertical-spacer","screenshot-button","stop-reload-button","back-button","customizableui-special-spring232","customizableui-special-spring233","customizableui-special-spring237","customizableui-special-spring238","customizableui-special-spring241","customizableui-special-spring243","customizableui-special-spring244","customizableui-special-spring247","customizableui-special-spring249","customizableui-special-spring253","customizableui-special-spring256","customizableui-special-spring259","customizableui-special-spring262","customizableui-special-spring265","customizableui-special-spring268","customizableui-special-spring271","customizableui-special-spring274","customizableui-special-spring278","customizableui-special-spring281","customizableui-special-spring284","customizableui-special-spring287","customizableui-special-spring290","customizableui-special-spring293","customizableui-special-spring296","customizableui-special-spring303","customizableui-special-spring304","customizableui-special-spring308","customizableui-special-spring310","customizableui-special-spring313","customizableui-special-spring315","customizableui-special-spring318","customizableui-special-spring322","customizableui-special-spring324","customizableui-special-spring327","urlbar-container","customizableui-special-spring326","customizableui-special-spring323","customizableui-special-spring321","customizableui-special-spring317","customizableui-special-spring314","customizableui-special-spring312","customizableui-special-spring309","customizableui-special-spring307","customizableui-special-spring305","customizableui-special-spring302","customizableui-special-spring295","customizableui-special-spring292","customizableui-special-spring289","customizableui-special-spring286","customizableui-special-spring283","customizableui-special-spring280","customizableui-special-spring277","customizableui-special-spring273","customizableui-special-spring270","customizableui-special-spring267","customizableui-special-spring264","customizableui-special-spring261","customizableui-special-spring258","customizableui-special-spring255","customizableui-special-spring252","customizableui-special-spring250","customizableui-special-spring246","customizableui-special-spring245","customizableui-special-spring242","customizableui-special-spring240","customizableui-special-spring239","customizableui-special-spring236","customizableui-special-spring235","customizableui-special-spring234","forward-button","ublock0_raymondhill_net-browser-action","unified-extensions-button"],"TabsToolbar":["tabbrowser-tabs"],"vertical-tabs":[],"PersonalToolbar":["personal-bookmarks"],"toolbar-menubar":["menubar-items"]},"seen":[],"dirtyAreaCache":["nav-bar","vertical-tabs","PersonalToolbar","unified-extensions-area","TabsToolbar","toolbar-menubar"],"currentVersion":23,"newElementCount":327}');
defaultPref("browser.uiCustomization.horizontalTabstrip", '["tabbrowser-tabs"]');
defaultPref("browser.uiCustomization.navBarWhenVerticalTabs", '["vertical-spacer","screenshot-button","stop-reload-button","back-button","customizableui-special-spring232","customizableui-special-spring233","customizableui-special-spring237","customizableui-special-spring238","customizableui-special-spring241","customizableui-special-spring243","customizableui-special-spring244","customizableui-special-spring247","customizableui-special-spring249","customizableui-special-spring253","customizableui-special-spring256","customizableui-special-spring259","customizableui-special-spring262","customizableui-special-spring265","customizableui-special-spring268","customizableui-special-spring271","customizableui-special-spring274","customizableui-special-spring278","customizableui-special-spring281","customizableui-special-spring284","customizableui-special-spring287","customizableui-special-spring290","customizableui-special-spring293","customizableui-special-spring296","customizableui-special-spring303","customizableui-special-spring304","customizableui-special-spring308","customizableui-special-spring310","customizableui-special-spring313","customizableui-special-spring315","customizableui-special-spring318","customizableui-special-spring322","customizableui-special-spring324","customizableui-special-spring327","urlbar-container","customizableui-special-spring326","customizableui-special-spring323","customizableui-special-spring321","customizableui-special-spring317","customizableui-special-spring314","customizableui-special-spring312","customizableui-special-spring309","customizableui-special-spring307","customizableui-special-spring305","customizableui-special-spring302","customizableui-special-spring295","customizableui-special-spring292","customizableui-special-spring289","customizableui-special-spring286","customizableui-special-spring283","customizableui-special-spring280","customizableui-special-spring277","customizableui-special-spring273","customizableui-special-spring270","customizableui-special-spring267","customizableui-special-spring264","customizableui-special-spring261","customizableui-special-spring258","customizableui-special-spring255","customizableui-special-spring252","customizableui-special-spring250","customizableui-special-spring246","customizableui-special-spring245","customizableui-special-spring242","customizableui-special-spring240","customizableui-special-spring239","customizableui-special-spring236","customizableui-special-spring235","customizableui-special-spring234","forward-button","ublock0_raymondhill_net-browser-action","unified-extensions-button"]');
clearPref("browser.uiCustomization.state"); // Temporary, to ensure our new setting below takes effect, due to how Firefox handles this
defaultPref("browser.uiCustomization.state", '{"placements":{"widget-overflow-fixed-list":[],"unified-extensions-area":[],"nav-bar":["vertical-spacer","screenshot-button","back-button","forward-button","customizableui-special-spring232","customizableui-special-spring233","customizableui-special-spring237","customizableui-special-spring238","customizableui-special-spring241","customizableui-special-spring243","customizableui-special-spring244","customizableui-special-spring247","customizableui-special-spring249","customizableui-special-spring253","customizableui-special-spring256","customizableui-special-spring259","customizableui-special-spring262","customizableui-special-spring265","customizableui-special-spring268","customizableui-special-spring271","customizableui-special-spring274","customizableui-special-spring278","customizableui-special-spring281","customizableui-special-spring284","customizableui-special-spring287","customizableui-special-spring290","customizableui-special-spring293","customizableui-special-spring296","customizableui-special-spring303","customizableui-special-spring304","customizableui-special-spring308","customizableui-special-spring310","customizableui-special-spring313","customizableui-special-spring315","customizableui-special-spring318","customizableui-special-spring322","customizableui-special-spring324","customizableui-special-spring327","stop-reload-button","urlbar-container","home-button","customizableui-special-spring339","customizableui-special-spring326","customizableui-special-spring323","customizableui-special-spring321","customizableui-special-spring317","customizableui-special-spring314","customizableui-special-spring312","customizableui-special-spring309","customizableui-special-spring307","customizableui-special-spring305","customizableui-special-spring302","customizableui-special-spring295","customizableui-special-spring292","customizableui-special-spring289","customizableui-special-spring286","customizableui-special-spring283","customizableui-special-spring280","customizableui-special-spring277","customizableui-special-spring273","customizableui-special-spring270","customizableui-special-spring267","customizableui-special-spring264","customizableui-special-spring261","customizableui-special-spring258","customizableui-special-spring255","customizableui-special-spring252","customizableui-special-spring250","customizableui-special-spring246","customizableui-special-spring245","customizableui-special-spring242","customizableui-special-spring240","customizableui-special-spring239","customizableui-special-spring236","customizableui-special-spring235","customizableui-special-spring234","ublock0_raymondhill_net-browser-action","unified-extensions-button","fullscreen-button"],"TabsToolbar":[],"vertical-tabs":["tabbrowser-tabs"],"PersonalToolbar":["personal-bookmarks"],"toolbar-menubar":["menubar-items"]},"seen":[],"dirtyAreaCache":["nav-bar","vertical-tabs","PersonalToolbar","unified-extensions-area","TabsToolbar","toolbar-menubar"],"currentVersion":23,"newElementCount":339}');

/// Hide UI to add custom search engines at `about:preferences#search`
defaultPref("browser.urlbar.update2.engineAliasRefresh", false);

/// Hide UI to automatically delete files downloaded in Private Browsing
defaultPref("browser.download.enableDeletePrivate", false);

/// Hide UI to switch search engines for individual searches
defaultPref("browser.urlbar.scotchBonnet.disableOneOffs", true); // [HIDDEN]

/// If containers are enabled, set Firefox to always ask for container selection on new tabs
// Useful for having multiple accounts/instances of websites
defaultPref("privacy.userContext.newTabContainerOnLeftClick.enabled", true);

/// Remove link to download themes
defaultPref("lightweightThemes.getMoreURL", "");

/// Remove placeholder shortcut
defaultPref("browser.newtabpage.pinned", ""); // [DEFAULT]

/// Remove unnecessary URL Bar shortcuts
defaultPref("browser.urlbar.shortcuts.bookmarks", false);
defaultPref("browser.urlbar.shortcuts.history", false);
defaultPref("browser.urlbar.shortcuts.tabs", false);

defaultPref("browser.phoenix.status.specialized", "001");

/*** 002 DEBLOAT ***/

// These also provide Attack Surface Reduction

/// Disable add-on abuse reporting
defaultPref("extensions.abuseReport.enabled", false);

/// Disable alerts for breached and vulnerable passwords
defaultPref("browser.contentblocking.report.monitor.home_page_url", "");
defaultPref("browser.contentblocking.report.monitor.how_it_works.url", "");
defaultPref("browser.contentblocking.report.monitor.preferences_url", "");
defaultPref("browser.contentblocking.report.monitor.sign_in_url", "");
defaultPref("browser.contentblocking.report.monitor.url", "");
defaultPref("signon.management.page.breach-alerts.enabled", false);
defaultPref("signon.management.page.breachAlertUrl", "");
defaultPref("signon.management.page.vulnerable-passwords.enabled", false);

/// Disable Android Debugging
defaultPref("devtools.remote.adb.extensionID", "");
defaultPref("devtools.remote.adb.extensionURL", "");

/// Disable back-up/import/export of bookmarks
defaultPref("browser.bookmarks.autoExportHTML", false); // [DEFAULT]
defaultPref("browser.bookmarks.max_backups", 0);
defaultPref("browser.bookmarks.restore_default_bookmarks", false); // [HIDDEN] [DEFAULT]
defaultPref("browser.places.importBookmarksHTML", false); // [HIDDEN] [DEFAULT]

/// Disable background tasks
defaultPref("dom.quotaManager.backgroundTask.enabled", false); // [DEFAULT]
defaultPref("network.cache.shutdown_purge_in_background_task", false); // [DEFAULT]

/// Disable BackupService
// https://searchfox.org/mozilla-central/source/browser/components/backup/content/debug.html
defaultPref("browser.backup.archive.enabled", false); // [DEFAULT]
defaultPref("browser.backup.enabled", false);
defaultPref("browser.backup.preferences.ui.enabled", false); // [DEFAULT]
defaultPref("browser.backup.restore.enabled", false); // [DEFAULT]
defaultPref("browser.backup.scheduled.enabled", false); // [DEFAULT]
defaultPref("browser.backup.scheduled.user-disabled", true);

/// Disable Containers
// https://support.mozilla.org/kb/how-use-firefox-containers
defaultPref("privacy.userContext.enabled", false);
defaultPref("privacy.userContext.ui.enabled", false);

/// Disable DRM/EME
defaultPref("media.eme.encrypted-media-encryption-scheme.enabled", false);
defaultPref("media.eme.hdcp-policy-check.enabled", false);
defaultPref("media.gmp-widevinecdm.visible", false);
defaultPref("media.gmp-widevinecdm-l1.visible", false); // [DEFAULT - non-Nightly]

/// Disable file picker dialogs
defaultPref("widget.disable_file_pickers", true);
defaultPref("widget.use-xdg-desktop-portal.file-picker", 0); // Linux (GTK)

/// Disable Firefox Bridge
defaultPref("browser.firefoxbridge.extensionOrigins", "");

/// Disable Firefox Home
defaultPref("browser.newtab.preload", false);
defaultPref("browser.newtabpage.activity-stream.discoverystream.config", '{"collapsible":true,"enabled":false}');
defaultPref("browser.newtabpage.activity-stream.discoverystream.enabled", false);
defaultPref("browser.newtabpage.activity-stream.discoverystream.endpoints", "");
defaultPref("browser.newtabpage.activity-stream.discoverystream.merino-provider.enabled", false);
defaultPref("browser.newtabpage.activity-stream.discoverystream.merino-provider.endpoint", "");
defaultPref("browser.newtabpage.activity-stream.discoverystream.ohttp.configURL", "");
defaultPref("browser.newtabpage.activity-stream.discoverystream.ohttp.relayURL", "");
defaultPref("browser.newtabpage.activity-stream.feeds.aboutpreferences", false);
defaultPref("browser.newtabpage.activity-stream.feeds.discoverystreamfeed", false);
defaultPref("browser.newtabpage.activity-stream.feeds.listsfeed", false);
defaultPref("browser.newtabpage.activity-stream.feeds.newtabinit", false);
defaultPref("browser.newtabpage.activity-stream.feeds.places", false);
defaultPref("browser.newtabpage.activity-stream.feeds.prefs", false);
defaultPref("browser.newtabpage.activity-stream.feeds.recommendationprovider", false);
defaultPref("browser.newtabpage.activity-stream.feeds.sections", false);
defaultPref("browser.newtabpage.activity-stream.feeds.smartshortcutsfeed", false);
defaultPref("browser.newtabpage.activity-stream.feeds.startupcacheinit", false);
defaultPref("browser.newtabpage.activity-stream.feeds.system.topsites", false);
defaultPref("browser.newtabpage.activity-stream.feeds.systemtick", false);
defaultPref("browser.newtabpage.activity-stream.feeds.timerfeed", false);
defaultPref("browser.newtabpage.activity-stream.feeds.topsites", false);
defaultPref("browser.newtabpage.activity-stream.feeds.trendingsearchfeed", false);
defaultPref("browser.newtabpage.activity-stream.feeds.weatherfeed", false);
defaultPref("browser.newtabpage.activity-stream.newtabWallpapers.enabled", false);
defaultPref("browser.newtabpage.activity-stream.showSearch", false);
defaultPref("browser.newtabpage.activity-stream.support.url", "");
defaultPref("browser.newtabpage.activity-stream.system.showWeather", false);
defaultPref("browser.newtabpage.activity-stream.testing.shouldInitializeFeeds", false);
defaultPref("browser.newtabpage.activity-stream.widgets.focusTimer.enabled", false);
defaultPref("browser.newtabpage.activity-stream.widgets.lists.enabled", false);
defaultPref("browser.newtabpage.activity-stream.widgets.system.enabled", false); // [DEFAULT]
defaultPref("browser.newtabpage.activity-stream.widgets.system.focusTimer.enabled", false); // [DEFAULT]
defaultPref("browser.newtabpage.activity-stream.widgets.system.lists.enabled", false); // [DEFAULT]
defaultPref("browser.newtabpage.enabled", false);
defaultPref("browser.startup.homepage.abouthome_cache.enabled", false);

/// Disable Firefox Relay
defaultPref("signon.firefoxRelay.base_url", "");
defaultPref("signon.firefoxRelay.feature", "not available");
defaultPref("signon.firefoxRelay.learn_more_url", "");
defaultPref("signon.firefoxRelay.manage_url", "");
defaultPref("signon.firefoxRelay.privacy_policy_url", "");
defaultPref("signon.firefoxRelay.terms_of_service_url", "");

/// Disable Firefox Sync
defaultPref("identity.fxaccounts.auth.uri", "");
defaultPref("identity.fxaccounts.autoconfig.uri", ""); // [DEFAULT]
defaultPref("identity.fxaccounts.commands.remoteTabManagement.enabled", false);
defaultPref("identity.fxaccounts.enabled", false);
defaultPref("identity.fxaccounts.oauth.enabled", false);
defaultPref("identity.fxaccounts.pairing.enabled", false);
defaultPref("identity.fxaccounts.remote.oauth.uri", "");
defaultPref("identity.fxaccounts.remote.pairing.uri", "");
defaultPref("identity.fxaccounts.remote.profile.uri", "");
defaultPref("identity.fxaccounts.remote.root", "");
defaultPref("identity.fxaccounts.toolbar.defaultVisible", false); // Hide toolbar icon
defaultPref("identity.fxaccounts.toolbar.enabled", false);
defaultPref("identity.sync.tokenserver.uri", "");
defaultPref("services.sync.engine.addresses.available", false); // [DEFAULT]
defaultPref("services.sync.engine.creditcards.available", false);
defaultPref("services.sync.syncedTabs.showRemoteIcons", false);
defaultPref("webextensions.storage.sync.enabled", false); // [HIDDEN]
defaultPref("webextensions.storage.sync.kinto", false); // [DEFAULT]
defaultPref("webextensions.storage.sync.serverURL", "");

/// Disable Firefox View virtual list
defaultPref("browser.firefox-view.virtual-list.enabled", false);

/// Disable machine learning
defaultPref("browser.aiwindow.enabled", false); // [NIGHTLY] [DEFAULT]
defaultPref("browser.ml.chat.provider", "");
defaultPref("browser.ml.chat.sidebar", false);
defaultPref("browser.ml.enable", false);
defaultPref("browser.ml.modelHubRootUrl", "");
defaultPref("extensions.ml.enabled", false);

/// Disable 'Migration' functionality...
defaultPref("browser.migrate.bookmarks-file.enabled", false);
defaultPref("browser.migrate.brave.enabled", false);
defaultPref("browser.migrate.canary.enabled", false);
defaultPref("browser.migrate.chrome.enabled", false);
defaultPref("browser.migrate.chrome.extensions.enabled", false);
defaultPref("browser.migrate.chrome.get_permissions.enabled", false);
defaultPref("browser.migrate.chrome.payment_methods.enabled", false);
defaultPref("browser.migrate.chrome-beta.enabled", false);
defaultPref("browser.migrate.chrome-dev.enabled", false);
defaultPref("browser.migrate.chromium.enabled", false);
defaultPref("browser.migrate.chromium-360se.enabled", false);
defaultPref("browser.migrate.chromium-edge.enabled", false);
defaultPref("browser.migrate.chromium-edge-beta.enabled", false);
defaultPref("browser.migrate.content-modal.import-all.enabled", false);
defaultPref("browser.migrate.edge.enabled", false);
defaultPref("browser.migrate.firefox.enabled", false);
defaultPref("browser.migrate.ie.enabled", false);
defaultPref("browser.migrate.interactions.bookmarks", false);
defaultPref("browser.migrate.interactions.csvpasswords", false);
defaultPref("browser.migrate.interactions.history", false);
defaultPref("browser.migrate.interactions.passwords", false);
defaultPref("browser.migrate.opera.enabled", false);
defaultPref("browser.migrate.opera-gx.enabled", false);
defaultPref("browser.migrate.preferences-entrypoint.enabled", false);
defaultPref("browser.migrate.safari.enabled", false);
defaultPref("browser.migrate.vivaldi.enabled", false);
defaultPref("extensions.getAddons.browserMappings.url", ""); // This is used for mapping Chrome extensions with Firefox ones, as part of browser migration: https://mozilla.github.io/addons-server/topics/api/addons.html#browser-mappings - ex. https://services.addons.mozilla.org/api/v5/addons/browser-mappings/?browser=chrome
defaultPref("signon.showAutoCompleteImport", "");
defaultPref("signon.suggestImportCount", 0);

/// Disable Narrator
defaultPref("narrate.enabled", false);

/// Disable Password Manager/Autofill
defaultPref("browser.contentblocking.report.lockwise.how_it_works.url", "");
defaultPref("browser.contextual-password-manager.enabled", false);
defaultPref("extensions.formautofill.addresses.capture.enabled", false);
defaultPref("extensions.formautofill.addresses.supported", "off");
defaultPref("extensions.formautofill.addresses.supportedCountries", "");
defaultPref("extensions.formautofill.creditCards.hideui", true); // [HIDDEN] https://searchfox.org/firefox-release/rev/9d94f5e3/toolkit/components/formautofill/FormAutofill.sys.mjs#29
defaultPref("extensions.formautofill.creditCards.supported", "off");
defaultPref("extensions.formautofill.creditCards.supportedCountries", "");
defaultPref("security.webauthn.show_ms_settings_link", false);
defaultPref("services.passwordSavingEnabled", false); // [HIDDEN]
defaultPref("signon.backup.enabled", false);
defaultPref("signon.capture.inputChanges.enabled", false);
defaultPref("signon.formRemovalCapture.enabled", false);
defaultPref("signon.generation.available", false);
defaultPref("signon.generation.enabled", false);
defaultPref("signon.passwordEditCapture.enabled", false);
defaultPref("signon.recipes.path", "");
defaultPref("signon.relatedRealms.enabled", false); // [DEFAULT]
defaultPref("signon.showAutoCompleteFooter", false);
defaultPref("signon.storeSignons", false); // [HIDDEN]
defaultPref("signon.usernameOnlyForm.enabled", false);

/// Disable PDF.js
defaultPref("browser.helperApps.showOpenOptionForPdfJS", false);

/// Disable Picture-in-Picture
defaultPref("media.videocontrols.picture-in-picture.audio-toggle.enabled", false);
defaultPref("media.videocontrols.picture-in-picture.enabled", false);
defaultPref("media.videocontrols.picture-in-picture.urlbar-button.enabled", false);
defaultPref("media.videocontrols.picture-in-picture.video-toggle.enabled", false);

/// Disable printing
defaultPref("print.enabled", false);
defaultPref("print.show_page_setup_menu", false);

/// Disable Reader Mode
defaultPref("reader.parse-on-load.enabled", false);

/// Disable support for web applications manifests
defaultPref("dom.manifest.enabled", false);

/// Disable Taskbar Tabs (PWAs)
defaultPref("browser.taskbarTabs.enabled", false);

/// Disable text fragments
defaultPref("dom.text_fragments.create_text_fragment.enabled", false);
defaultPref("dom.text_fragments.enabled", false);

/// Disable user certificate/key databases
defaultPref("security.nocertdb", true);

/// Do not try to open internally-handled attachments
defaultPref("browser.download.force_save_internally_handled_attachments", true);
defaultPref("browser.download.viewableInternally.enabledTypes", "");
defaultPref("browser.helperApps.showOpenOptionForViewableInternally", false);

defaultPref("browser.phoenix.status.specialized", "002");

/*** 003 PRIVACY + SECURITY ***/

/// Disable WebGL
// PRIVACY: Fingerprinting concerns
// SECURITY: Attack Surface Reduction
// https://blog.browserscan.net/docs/webgl-fingerprinting
// https://security.stackexchange.com/questions/13799/is-webgl-a-security-concern
defaultPref("webgl.disabled", true);

defaultPref("browser.phoenix.status.specialized", "003");

/*** 004 PRIVACY ***/

/// Clear cookies by default at `about:preferences#privacy` -> `Cookies and Site Data` -> `Manage Data...`
// We don't have to worry about exceptions for our use case...
defaultPref("privacy.clearHistory.cookiesAndStorage", true); // [DEFAULT]
defaultPref("privacy.clearSiteData.cookiesAndStorage", true); // [DEFAULT]
defaultPref("privacy.cpd.cookies", true); // [DEFAULT]
defaultPref("privacy.cpd.offlineApps", true);

/// Disable browsing history
defaultPref("places.history.enabled", false);

/// Disable geolocation
defaultPref("browser.geolocation.warning.infoURL", "");
defaultPref("geo.prompt.open_system_prefs", false); // Ensure users aren't prompted to open settings and enable Geolocation - https://searchfox.org/mozilla-central/rev/20fc11f1/modules/libpref/init/StaticPrefList.yaml#6406
defaultPref("geo.provider.network.scan", false);
defaultPref("geo.provider.network.url", "");
defaultPref("geo.provider.use_geoclue", false); // [LINUX-ONLY]
defaultPref("network.wifi.scanning_period", 0);
defaultPref("widget.use-xdg-desktop-portal.location", 0); // [LINUX-ONLY]

/// Disable origin headers
defaultPref("network.http.sendOriginHeader", 0);

/// Disable referers
defaultPref("network.http.referer.defaultPolicy", 0);
defaultPref("network.http.referer.defaultPolicy.pbmode", 0);
defaultPref("network.http.referer.defaultPolicy.trackers", 0);
defaultPref("network.http.referer.defaultPolicy.trackers.pbmode", 0);
defaultPref("network.http.referer.sendFromRefresh", false);
defaultPref("network.http.referer.trimmingPolicy", 2);
defaultPref("network.http.sendRefererHeader", 0);

/// Disable session restore
defaultPref("browser.sessionhistory.max_entries", 1);
defaultPref("browser.sessionstore.closedTabsFromAllWindows", false);
defaultPref("browser.sessionstore.closedTabsFromClosedWindows", false);
defaultPref("browser.sessionstore.debug.no_auto_updates", true);
defaultPref("browser.sessionstore.max_resumed_crashes", 0);
defaultPref("browser.sessionstore.max_serialize_back", 0);
defaultPref("browser.sessionstore.max_serialize_forward", 0);
defaultPref("browser.sessionstore.max_tabs_undo", 0);
defaultPref("browser.sessionstore.max_windows_undo", 0);
defaultPref("browser.sessionstore.resume_from_crash", false);
defaultPref("browser.sessionstore.resume_session_once", false); // [DEFAULT]
defaultPref("browser.sessionstore.resuming_after_os_restart", false); // [DEFAULT]
defaultPref("browser.sessionstore.restore_on_demand", false);
defaultPref("browser.sessionstore.restore_windows_to_virtual_desktop", false);
defaultPref("browser.sessionstore.persist_closed_tabs_between_sessions", false);
defaultPref("browser.sessionstore.upgradeBackup.maxUpgradeBackups", 0);
defaultPref("browser.startup.couldRestoreSession.count", -1);
defaultPref("privacy.clearOnShutdown.openWindows", true);
defaultPref("privacy.cpd.openWindows", true);

/// On first launch, load a blank homepage
// For specialized configs, we override the homepage to one that belongs to the desired website/service for the config
// But, if we immediately load the webpage on first run, it will bypass uBlock Origin, as uBlock Origin won't be installed yet
// So, to give uBlock Origin time to install, we can set this to a blank/empty homepage, only for the first run
defaultPref("browser.startup.firstrunSkipsHomepage", true); // [DEFAULT]
unlockPref("browser.startup.homepage_override.mstone");
defaultPref("browser.startup.homepage_override.mstone", "");
defaultPref("startup.homepage_welcome_url", "file:///etc/firefox/phoenix/assets/spec-welcome.txt"); // [LINUX-NON-FLATPAK-ONLY]

/// Reset ETP exceptions
// Unnecessary/undesired for our use case...
defaultPref("urlclassifier.trackingSkipURLs", ""); // [DEFAULT] [HIDDEN]

/// Reset Phoenix's FPP overrides
// Unnecessary/undesired for our use case...
defaultPref("privacy.fingerprintingProtection.granularOverrides", ""); // [DEFAULT]

defaultPref("browser.phoenix.status.specialized", "004");

/*** 005 SECURITY ***/

/// Block permission prompts to access camera
defaultPref("permissions.default.camera", 2);

/// Block permission prompts to access microphone
defaultPref("permissions.default.microphone", 2);

/// Configure protocol handling
defaultPref("network.protocol-handler.expose.file", false);
defaultPref("network.protocol-handler.expose.http", false);
defaultPref("network.protocol-handler.expose.https", false);
defaultPref("network.protocol-handler.expose.javascript", false);
defaultPref("network.protocol-handler.external.file", true);
defaultPref("network.protocol-handler.external.javascript", true);

/// Disable SVG
// https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=firefox+svg
defaultPref("svg.disabled", true);

/// Disable WebRTC
// https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=webrtc
// https://x.com/GrapheneOS/status/1728921946396725618
defaultPref("media.peerconnection.enabled", false);

defaultPref("browser.phoenix.status.specialized", "005");

/*** 006 MISC. ***/

/// Always open links in existing browser window
defaultPref("browser.link.open_newwindow", 1);
defaultPref("browser.link.open_newwindow.disabled_in_fullscreen", false);
defaultPref("browser.link.open_newwindow.restriction", 1);
defaultPref("browser.link.open_newwindow.override.external", 1);
defaultPref("browser.search.context.loadInBackground", false); // [DEFAULT]
defaultPref("browser.tabs.loadBookmarksInBackground", false); // [DEFAULT]
defaultPref("browser.tabs.loadBookmarksInTabs", false); // [DEFAULT]
defaultPref("browser.tabs.loadDivertedInBackground", false); // [DEFAULT]
defaultPref("browser.tabs.loadInBackground", false);
defaultPref("browser.tabs.opentabfor.middleclick", false);
defaultPref("middlemouse.openNewWindow", false); // [DEFAULT - non-Android/non-Unix (non-macOS)]
defaultPref("view_source.tab", false);

/// Ensure we don't try to load various URLs internally
// We're intentionally using "htps" here - because, since we disable URL fix-up below, this prevents these URLs from loading in the specialized config - but, since regular Phoenix/Firefox profiles have URL fix-up enabled, when pasting the URL into the URL bar there, it will automatically switch to HTTPS and take users to the correct place
// For other URLs that we don't want/need at all here, we can just set them to empty values
lockPref("app.releaseNotesURL", "");
lockPref("app.releaseNotesURL.aboutDialog", "");
lockPref("app.releaseNotesURL.prompt", "");
defaultPref("app.support.baseURL", "htps://support.mozilla.org/1/firefox/%VERSION%/%OS%/%LOCALE%/");
lockPref("app.update.url.details", "");
lockPref("app.update.url.manual", "");
defaultPref("browser.backup.template.fallback-download.aurora", "");
defaultPref("browser.backup.template.fallback-download.beta", "");
defaultPref("browser.backup.template.fallback-download.esr", "");
defaultPref("browser.backup.template.fallback-download.nightly", "");
defaultPref("browser.backup.template.fallback-download.release", "");
defaultPref("browser.contentblocking.report.cookie.url", "htps://support.mozilla.org/kb/trackers-and-scripts-firefox-blocks-enhanced-track#w_cross-site-tracking-cookies");
defaultPref("browser.contentblocking.report.cryptominer.url", "htps://support.mozilla.org/kb/trackers-and-scripts-firefox-blocks-enhanced-track#w_cryptominers");
defaultPref("browser.contentblocking.report.fingerprinter.url", "htps://support.mozilla.org/kb/trackers-and-scripts-firefox-blocks-enhanced-track#w_fingerprinters");
defaultPref("browser.contentblocking.report.social.url", "htps://support.mozilla.org/kb/trackers-and-scripts-firefox-blocks-enhanced-track#w_social-media-trackers");
defaultPref("browser.contentblocking.report.tracker.url", "htps://support.mozilla.org/kb/trackers-and-scripts-firefox-blocks-enhanced-track#w_tracking-content");
defaultPref("browser.dictionaries.download.url", "htps://addons.mozilla.org/language-tools/");
defaultPref("browser.lna.warning.infoURL", "htps://support.mozilla.org/kb/control-personal-device-local-network-permissions-firefox");
defaultPref("browser.safebrowsing.provider.google.advisoryURL", "htps://developers.google.com/safe-browsing/v4/advisory");
defaultPref("browser.safebrowsing.provider.google4.advisoryURL", "htps://developers.google.com/safe-browsing/v4/advisory");
defaultPref("browser.safebrowsing.provider.google5.advisoryURL", "htps://developers.google.com/safe-browsing/v4/advisory");
defaultPref("browser.safebrowsing.reportPhishURL", "htps://safebrowsing.google.com/safebrowsing/report_phish/?tpl=mozilla&url=");
defaultPref("browser.xr.warning.infoURL", "");
defaultPref("extensions.abuseReport.amoFormURL", "");
defaultPref("extensions.blocklist.addonItemURL", "htps://addons.mozilla.org/blocked-addon/%addonID%/%addonVersion%/");
defaultPref("extensions.webcompat-reporter.newIssueEndpoint", "htps://phoenix.celenity.dev/issues");
defaultPref("media.decoder-doctor.new-issue-endpoint", "htps://phoenix.celenity.dev/issues");
defaultPref("network.trr_ui.skip_reason_learn_more_url");
defaultPref("pdfjs.altTextLearnMoreUrl", "htps://firefox-source-docs.mozilla.org/networking/dns/trr-skip-reasons.html#");
defaultPref("ui.new-webcompat-reporter.new-report-endpoint", "htps://phoenix.celenity.dev/issues");

/// Close tabs upon double click
// This is to compensate for us disabling the display of separate tabs
defaultPref("browser.tabs.closeTabByDblclick", true);

/// Disable favicons
defaultPref("browser.chrome.guess_favicon", false); // [HIDDEN]
defaultPref("browser.chrome.site_icons", false);

/// Disable saving links upon left click + save
// https://searchfox.org/firefox-release/rev/9d94f5e3/toolkit/modules/BrowserUtils.sys.mjs#471
defaultPref("browser.altClickSave", false); // [DEFAULT]

/// Disable tab switching with Ctrl+Tab
defaultPref("browser.ctrlTab.disallowForScreenReaders", true); // [HIDDEN]

/// Disable toolbar keyboard navigation
defaultPref("browser.toolbars.keyboard_navigation", false);

/// Disable URL fix-up
defaultPref("browser.fixup.alternate.prefix", "");
defaultPref("browser.fixup.alternate.protocol", "");
defaultPref("browser.fixup.alternate.suffix", "");
defaultPref("browser.fixup.typo.scheme", false); // [HIDDEN]
defaultPref("browser.urlbar.ctrlCanonizesURLs", false);
defaultPref("browser.urlbar.dnsResolveFullyQualifiedNames", false); // [HIDDEN]
defaultPref("security.bad_cert_domain_error.url_fix_enabled", false); // https://searchfox.org/firefox-main/rev/82e2435f/docshell/base/nsDocShell.cpp#6251

/// Do not try to unload tabs on low memory
defaultPref("browser.tabs.unloadOnLowMemory", false); // [DEFAULT - non-macOS/Windows]

/// Do not warn on closing tabs
defaultPref("browser.tabs.warnOnClose", false); // [DEFAULT]
defaultPref("browser.tabs.warnOnCloseOtherTabs", false);

/// Do not warn on quit
defaultPref("browser.warnOnQuit", false);
defaultPref("browser.warnOnQuitShortcut", false);

/// Remove default Search Engine Placeholders
defaultPref("browser.newtabpage.activity-stream.trendingSearch.defaultSearchEngine", ""); // [HIDDEN] [DEFAULT] [NIGHTLY] For the "Trending search results" widget on Firefox Home (`about:home`) https://searchfox.org/mozilla-central/source/browser/extensions/newtab/lib/TrendingSearchFeed.sys.mjs
defaultPref("browser.urlbar.placeholderName", "");
defaultPref("browser.urlbar.placeholderName.private", "");

defaultPref("browser.phoenix.status.specialized", "006");

lockPref("browser.phoenix.status.specialized", "successfully applied :D");
//

//
// Copyright (C) 2024-2025 celenity
//
// This file is part of Phoenix.
//
// Phoenix is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.
//
// Phoenix is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along with Phoenix. If not, see https://www.gnu.org/licenses/.
//

// This contains preferences specifically tailored for X/Twitter.

/// Add custom branding at `about:support`
lockPref("app.support.vendor", "Phoenix - Twitter SC: 2025.11.27.1"); // [HIDDEN]

/// Add custom branding under `Firefox Updates` at `about:preferences#general`
// This will unfortunately only display if the version of Firefox you're using is repackaged (ex. Flatpaks/Linux distros)
lockPref("distribution.about", "Phoenix - Twitter SC for Mozilla Firefox: 2025.11.27.1 ðŸ’œ"); // [HIDDEN]

/* INDEX 

001: PRIVACY
002: UNBREAK

*/

/// Load Twitter...
defaultPref("browser.startup.homepage", "https://x.com/home");

/*** 001 PRIVACY ***/

/// Expand domain blocklist
defaultPref("network.dns.localDomains", "250analytics.com,a.omappapi.com,activity-stream-icons.services.mozilla.com,ads.allizom.org,ads.mozilla.org,ads.nonprod.webservices.mozgcp.net,ads.prod.webservices.mozgcp.net,ads-img.mozilla.org,analytics.getpocket.com,analytics.google.com,analytics.withgoogle.com,anf1.fuzzing.mozilla.org,anonymco.com,api.divviup.org,asan-nightly-frontend-elb-1348905149.us-east-2.elb.amazonaws.com,braze.com,contile.services.mozilla.com,contile-images.services.mozilla.com,classify-client.nonprod.webservices.mozgcp.net,classify-client.prod.webservices.mozgcp.net,classify-client.services.mozilla.com,crash-reports.allizom.org,crash-reports.mozilla.com,crash-reports-xpsp2.mozilla.com,crash-stacks.mozilla.com,crash-stats.allizom.org,crash-stats.mozilla.com,crash-stats.mozilla.org,dap.services.mozilla.com,dap.nonprod.webservices.mozgcp.net,dap.prod.webservices.mozgcp.net,dap-09-3.api.divviup.org,data.mozilla.com,data-ingestion.prod.dataops.mozgcp.net,dataops.mozgcp.net,dataservices.mozgcp.net,debug-ping-preview.firebaseapp.com,discovery.addons.allizom.org,discovery.addons.mozilla.org,discovery.addons-dev.allizom.org,divviup.org,download-stats.mozilla.org,download-stats.r53-2.services.mozilla.com,experimenter.services.mozilla.com,experimenter.nonprod.webservices.mozgcp.net,experimenter.prod.webservices.mozgcp.net,fhr.data.mozilla.com,fhr.r53-2.services.mozilla.com,firefox-android-home-recommendations.getpocket.com,firefox-dns-perf-test.net,fuzzing.mozilla.org,google-analytics.com,google-analytics-cn.com,googleanalytics.com,googlesyndication.com,googlesyndication-cn.com,googletagmanager.com,googletagmanager-cn.com,googletagservices.com,googletagservices-cn.com,improving.duckduckgo.com,incoming.glean.example.com,incoming.telemetry.mozilla.org,incoming.thunderbird.net,incoming-telemetry.thunderbird.net,ingestion-edge.prod.dataops.mozgcp.net,location.services.mozilla.com,locprod1-elb-eu-west-1.prod.mozaws.net,locprod2-elb-us-west-2.prod.mozaws.net,metrics-content.duckduckgo.com,new-sentry.gitlab.net,nonprod.classify-client.nonprod.webservices.mozgcp.net,normandy.cdn.mozilla.net,normandy.nonprod.cloudops.mozgcp.net,normandy.prod.cloudops.mozgcp.net,normandy-cdn.services.mozilla.com,omappapi.com,pipeline-incoming-prod-elb-149169523.us-west-2.elb.amazonaws.com,prod.ads.prod.webservices.mozgcp.net,prod.classify-client.prod.webservices.mozgcp.net,prod.dap.prod.webservices.mozgcp.net,prod.data-ingestion.prod.dataops.mozgcp.net,prod.dataops.mozgcp.net,prod.experimenter.prod.webservices.mozgcp.net,prod.ingestion-edge.prod.dataops.mozgcp.net,prod.sentry.prod.cloudops.mozgcp.net,prod-classifyclient.normandy.prod.cloudops.mozgcp.net,profile.accounts.firefox.com,sdk.iad-05.braze.com,search.r53-2.services.mozilla.com,search.services.mozilla.com,self-repair.mozilla.org,self-repair.r53-2.services.mozilla.com,sentry.gitlab.net,sentry.io,sentry.nonprod.cloudops.mozgcp.net,sentry.prod.cloudops.mozgcp.net,sentry.prod.mozaws.net,sitereview.zscaler.com,snippets.allizom.org,snippets.cdn.mozilla.net,snippets.mozilla.com,snippets-prod.frankfurt.moz.works,snippets-prod.moz.works,snippets-prod.oregon-b.moz.works,snippets-stage.moz.works,snippets-stage.oregon-b.moz.works,snowplow.trx.gitlab.net,snowplowalb-1011729428.us-east-1.elb.amazonaws.com,snowplowprd.trx.gitlab.net,snowplowprdnlb-1490493263.us-east-2.elb.amazonaws.com,socorro.nonprod.webservices.mozgcp.net,socorro.prod.webservices.mozgcp.net,socorro-collector.services.mozilla.com,socorro-webapp-allizom.stage.mozaws.net,socorro-webapp.services.mozilla.com,spocs.getpocket.com,spocs.getpocket.dev,spocs.mozilla.net,ssl.google-analytics.com,ssl-google-analytics.l.google.com,stage.sentry.nonprod.cloudops.mozgcp.net,start.fedoraproject.org,start.thunderbird.net,start.ubuntu.com,start-stage.thunderbird.net,survey.mozilla.com,tagmanager.google.com,talkback.mozilla.org,talkback-public.mozilla.org,talkback-reports.mozilla.org,telemetry-coverage.mozilla.org,telemetry-coverage.r53-2.services.mozilla.com,telemetry-experiment.cdn.mozilla.net,telemetry-incoming.r53-2.services.mozilla.com,telemetry-incoming-a.r53-2.services.mozilla.com,telemetry-incoming-b.r53-2.services.mozilla.com,telemetry-prod-1054754349.us-east-1.elb.amazonaws.com,tiles-cdn.prod.ads.prod.webservices.mozgcp.net,updates.thunderbird.net,updates-stage.thunderbird.net,use-application-dns.net,vf.startpage.com,widgets.getpocket.com,www.250analytics.com,www.anonymco.com,www.google-analytics.com,www.google-analytics-cn.com,www.googleanalytics.com,www.googlesyndication.com,www.googlesyndication-cn.com,www.googletagmanager.com,www.googletagmanager-cn.com,www.googletagservices.com,www.googletagservices-cn.com,www.sentry.io,www-google-analytics.l.google.com,www-googletagmanager.l.google.com,aa.twitter.com,aa.x.com,ads.twitter.com,ads.x.com,ads-api.twitter.com,ads-api.x.com,ads-api-sandbox.twitter.com,ads-bidder-api.twitter.com,ads-dev.twitter.com,ads-dev.x.com,ads-staging.twitter.com,ads-staging.x.com,ads-twitter.com,advertising.twitter.com,advertising.x.com,analytics.twitter.com,analytics.x.com,business.twitter.com,business.x.com,business-dev.twitter.com,business-dev.x.com,business-staging.twitter.com,business-staging.x.com,collector-ops.twitter.com,marketing.twitter.com,marketing.x.com,marketing-dev.twitter.com,marketing-dev.x.com,marketing-staging.twitter.com,marketing-staging.x.com,platform.twitter.com,platform.twitter.map.fastly.net,platform.x.com,platform-eb.twitter.com,syndication.twimg.com,syndication.twitter.com,syndication.x.com,www.ads-twitter.com,www.xadsacademy.com,xadsacademy.com");

defaultPref("browser.phoenix.status.specialized.twitter", "001");

/// Re-enable Containers
// https://support.mozilla.org/kb/how-use-firefox-containers
// (Useful here for ex. using different accounts)
defaultPref("privacy.userContext.enabled", true);
defaultPref("privacy.userContext.ui.enabled", true);

/*** 002 UNBREAK ***/

/// Only send cross-origin referers when base domains match (rather than only when hosts match)
// Required for images in DMs
// https://wiki.mozilla.org/Security/Referrer
defaultPref("network.http.referer.XOriginPolicy", 1);

/// Re-enable file picker dialogs
defaultPref("widget.disable_file_pickers", false);

/// Re-enable microphone permission prompts
// (For X/Twitter Spaces)
defaultPref("permissions.default.microphone", 0); // [DEFAULT]

/// Re-enable Picture-in-Picture
defaultPref("media.videocontrols.picture-in-picture.audio-toggle.enabled", true); // [DEFAULT]
defaultPref("media.videocontrols.picture-in-picture.enabled", true); // [DEFAULT]
defaultPref("media.videocontrols.picture-in-picture.urlbar-button.enabled", true); // [DEFAULT]
defaultPref("media.videocontrols.picture-in-picture.video-toggle.enabled", true); // [DEFAULT]

/// Re-enable referers
// Required for images in DMs
defaultPref("network.http.referer.defaultPolicy", 2);
defaultPref("network.http.referer.defaultPolicy.pbmode", 2);
defaultPref("network.http.sendRefererHeader", 2);

/// Re-enable SVG
defaultPref("svg.disabled", false);

// Re-enable WebAssembly
// Required for the E2EE chat feature
defaultPref("javascript.options.wasm", true); // [DEFAULT]

/// Re-enable WebRTC
// (For X/Twitter Spaces)
defaultPref("media.peerconnection.enabled", true); // [DEFAULT]

/// Relax WebRTC handling
// Required for speaking in X/Twitter Spaces
// You're welcome to override these if you don't have any plans to speak in X/Twitter spaces...
// Even listening appears to work fine without these, these are ONLY required for speaking
defaultPref("media.peerconnection.ice.no_host", false); // [DEFAULT]
defaultPref("media.peerconnection.ice.relay_only", false); // [DEFAULT]

/// Unbreak the "x" button to navigate back when viewing images
defaultPref("browser.sessionhistory.max_entries", 5);

defaultPref("browser.phoenix.status.specialized.twitter", "002");

lockPref("browser.phoenix.status.specialized.twitter", "successfully applied :D");


/// Adding prefs necessary for Firefox-UI-Fix https://github.com/black7375/Firefox-UI-Fix
/// Pulled from https://raw.githubusercontent.com/black7375/Firefox-UI-Fix/master/user.js

// ** Theme Related Options ****************************************************
// == Theme Distribution Settings ==============================================
// The rows that are located continuously must be changed `true`/`false` explicitly because there is a collision.
// https://github.com/black7375/Firefox-UI-Fix/wiki/Options#important
defaultPref("userChrome.tab.connect_to_window", true); // Original, Photon
defaultPref("userChrome.tab.color_like_toolbar", true); // Original, Photon

defaultPref("userChrome.tab.lepton_like_padding", true); // Original
defaultPref("userChrome.tab.photon_like_padding", false); // Photon

defaultPref("userChrome.tab.dynamic_separator", true); // Original, Proton
defaultPref("userChrome.tab.static_separator", false); // Photon
defaultPref("userChrome.tab.static_separator.selected_accent", false); // Just option
defaultPref("userChrome.tab.bar_separator", false); // Just option

defaultPref("userChrome.tab.newtab_button_like_tab", true); // Original
defaultPref("userChrome.tab.newtab_button_smaller", false); // Photon
defaultPref("userChrome.tab.newtab_button_proton", false); // Proton

defaultPref("userChrome.icon.panel_full", true); // Original, Proton
defaultPref("userChrome.icon.panel_photon", false); // Photon

// Original Only
defaultPref("userChrome.tab.box_shadow", true);
defaultPref("userChrome.tab.bottom_rounded_corner", true);

// Photon Only
defaultPref("userChrome.tab.photon_like_contextline", false);
defaultPref("userChrome.rounding.square_tab", false);

// Proton Only
// defaultPref("userChrome.tab.supernova_like_contextline",   true);

// == Theme Compatibility Settings =============================================
// defaultPref("userChrome.compatibility.accent_color",         true); // Firefox v103 Below
// defaultPref("userChrome.compatibility.covered_header_image", true);
// defaultPref("userChrome.compatibility.panel_cutoff",         true);
// defaultPref("userChrome.compatibility.navbar_top_border",    true);
// defaultPref("userChrome.compatibility.dynamic_separator",    true); // Need dynamic_separator

// defaultPref("userChrome.compatibility.os.linux_non_native_titlebar_button", true);
// defaultPref("userChrome.compatibility.os.windows_maximized", true);
// defaultPref("userChrome.compatibility.os.win11",             true);

// == Theme Custom Settings ====================================================
// -- User Chrome --------------------------------------------------------------
// defaultPref("userChrome.theme.private",                       true);
// defaultPref("userChrome.theme.proton_color.dark_blue_accent", true);
// defaultPref("userChrome.theme.monospace",                     true);
// defaultPref("userChrome.theme.transparent.frame",             true);
// defaultPref("userChrome.theme.transparent.menu",              true);
// defaultPref("userChrome.theme.transparent.panel",             true);
// defaultPref("userChrome.theme.non_native_menu",               true); // only for linux

// defaultPref("userChrome.decoration.disable_panel_animate",    true);
// defaultPref("userChrome.decoration.disable_sidebar_animate",  true);
// defaultPref("userChrome.decoration.panel_button_separator",   true);
// defaultPref("userChrome.decoration.panel_arrow",              true);

// defaultPref("userChrome.autohide.tab",                        true);
// defaultPref("userChrome.autohide.tab.opacity",                true);
// defaultPref("userChrome.autohide.tab.blur",                   true);
// defaultPref("userChrome.autohide.tabbar",                     true);
// defaultPref("userChrome.autohide.navbar",                     true);
// defaultPref("userChrome.autohide.bookmarkbar",                true);
// defaultPref("userChrome.autohide.sidebar",                    true);
// defaultPref("userChrome.autohide.fill_urlbar",                true);
// defaultPref("userChrome.autohide.back_button",                true);
// defaultPref("userChrome.autohide.forward_button",             true);
// defaultPref("userChrome.autohide.page_action",                true);
// defaultPref("userChrome.autohide.toolbar_overlap",            true);
// defaultPref("userChrome.autohide.toolbar_overlap.allow_layout_shift", true);

// defaultPref("userChrome.hidden.tab_icon",                     true);
// defaultPref("userChrome.hidden.tab_icon.always",              true);
// defaultPref("userChrome.hidden.tabbar",                       true);
// defaultPref("userChrome.hidden.navbar",                       true);
// defaultPref("userChrome.hidden.private_indicator",            true);
// defaultPref("userChrome.hidden.titlebar_container",           true);
// defaultPref("userChrome.hidden.sidebar_header",               true);
// defaultPref("userChrome.hidden.sidebar_header.vertical_tab_only", true);
// defaultPref("userChrome.hidden.urlbar_iconbox",               true);
// defaultPref("userChrome.hidden.urlbar_iconbox.label_only",    true);
// defaultPref("userChrome.hidden.bookmarkbar_icon",             true);
// defaultPref("userChrome.hidden.bookmarkbar_label",            true);
// defaultPref("userChrome.hidden.disabled_menu",                true);

// defaultPref("userChrome.centered.tab",                        true);
// defaultPref("userChrome.centered.tab.label",                  true);
// defaultPref("userChrome.centered.urlbar",                     true);
// defaultPref("userChrome.centered.bookmarkbar",                true);

// defaultPref("userChrome.counter.tab",                         true);
// defaultPref("userChrome.counter.bookmark_menu",               true);

// defaultPref("userChrome.combined.nav_button",                 true);
// defaultPref("userChrome.combined.nav_button.home_button",     true);
// defaultPref("userChrome.combined.urlbar.nav_button",          true);
// defaultPref("userChrome.combined.urlbar.home_button",         true);
// defaultPref("userChrome.combined.urlbar.reload_button",       true);
// defaultPref("userChrome.combined.sub_button.none_background", true);
// defaultPref("userChrome.combined.sub_button.as_normal",       true);

// defaultPref("userChrome.rounding.square_button",              true);
// defaultPref("userChrome.rounding.square_dialog",              true);
// defaultPref("userChrome.rounding.square_panel",               true);
// defaultPref("userChrome.rounding.square_panelitem",           true);
// defaultPref("userChrome.rounding.square_menupopup",           true);
// defaultPref("userChrome.rounding.square_menuitem",            true);
// defaultPref("userChrome.rounding.square_infobox",             true);
// defaultPref("userChrome.rounding.square_toolbar",             true);
// defaultPref("userChrome.rounding.square_field",               true);
// defaultPref("userChrome.rounding.square_urlView_item",        true);
// defaultPref("userChrome.rounding.square_checklabel",          true);

// defaultPref("userChrome.padding.first_tab",                   true);
// defaultPref("userChrome.padding.first_tab.always",            true);
// defaultPref("userChrome.padding.drag_space",                  true);
// defaultPref("userChrome.padding.drag_space.maximized",        true);

// defaultPref("userChrome.padding.toolbar_button.compact",      true);
// defaultPref("userChrome.padding.menu_compact",                true);
// defaultPref("userChrome.padding.bookmark_menu.compact",       true);
// defaultPref("userChrome.padding.urlView_expanding",           true);
// defaultPref("userChrome.padding.urlView_result",              true);
// defaultPref("userChrome.padding.panel_header",                true);

// defaultPref("userChrome.urlbar.iconbox_with_separator",       true);

// defaultPref("userChrome.urlView.as_commandbar",               true);
// defaultPref("userChrome.urlView.full_width_padding",          true);
// defaultPref("userChrome.urlView.always_show_page_actions",    true);
// defaultPref("userChrome.urlView.move_icon_to_left",           true);
// defaultPref("userChrome.urlView.go_button_when_typing",       true);
// defaultPref("userChrome.urlView.focus_item_border",           true);

// defaultPref("userChrome.tabbar.as_titlebar",                  true);
// defaultPref("userChrome.tabbar.fill_width",                   true);
// defaultPref("userChrome.tabbar.multi_row",                    true);
// defaultPref("userChrome.tabbar.unscroll",                     true);
// defaultPref("userChrome.tabbar.on_bottom",                    true);
// defaultPref("userChrome.tabbar.on_bottom.above_bookmark",     true); // Need on_bottom
// defaultPref("userChrome.tabbar.on_bottom.menubar_on_top",     true); // Need on_bottom
// defaultPref("userChrome.tabbar.on_bottom.hidden_single_tab",  true); // Need on_bottom
// defaultPref("userChrome.tabbar.one_liner",                    true);
// defaultPref("userChrome.tabbar.one_liner.combine_navbar",     true); // Need one_liner
// defaultPref("userChrome.tabbar.one_liner.tabbar_first",       true); // Need one_liner
// defaultPref("userChrome.tabbar.one_liner.responsive",         true); // Need one_liner

// defaultPref("userChrome.tab.bottom_rounded_corner.all",       true);
// defaultPref("userChrome.tab.bottom_rounded_corner.australis", true);
// defaultPref("userChrome.tab.bottom_rounded_corner.edge",      true);
// defaultPref("userChrome.tab.bottom_rounded_corner.chrome",    true);
// defaultPref("userChrome.tab.bottom_rounded_corner.chrome_legacy", true);
// defaultPref("userChrome.tab.bottom_rounded_corner.wave",      true);
// defaultPref("userChrome.tab.always_show_tab_icon",            true);
// defaultPref("userChrome.tab.close_button_at_pinned",          true);
// defaultPref("userChrome.tab.close_button_at_pinned.always",   true);
// defaultPref("userChrome.tab.close_button_at_pinned.background", true);
// defaultPref("userChrome.tab.close_button_at_hover.always",    true); // Need close_button_at_hover
// defaultPref("userChrome.tab.close_button_at_hover.with_selected", true);  // Need close_button_at_hover
// defaultPref("userChrome.tab.sound_show_label",                true); // Need remove sound_hide_label
// defaultPref("userChrome.tab.container.on_top",                true);
// defaultPref("userChrome.tab.container.always_long",           true);
// defaultPref("userChrome.tab.sound_with_favicons.on_center",   true);
// defaultPref("userChrome.tab.selected_bold",                   true);

// defaultPref("userChrome.navbar.as_sidebar",                   true);

// defaultPref("userChrome.bookmarkbar.multi_row",               true);

// defaultPref("userChrome.findbar.floating_on_top",             true);

// defaultPref("userChrome.panel.remove_strip",                  true);
// defaultPref("userChrome.panel.full_width_separator",          true);
// defaultPref("userChrome.panel.full_width_padding",            true);

// defaultPref("userChrome.sidebar.overlap",                     true);

// defaultPref("userChrome.icon.disabled",                       true);
// defaultPref("userChrome.icon.account_image_to_right",         true);
// defaultPref("userChrome.icon.account_label_to_right",         true);
// defaultPref("userChrome.icon.menu.full",                      true);
// defaultPref("userChrome.icon.global_menu.mac",                true);

// -- User Content -------------------------------------------------------------
// defaultPref("userContent.player.ui.twoline",                  true);

// defaultPref("userContent.newTab.hidden_logo",                 true);
// defaultPref("userContent.newTab.background_image",            true); // Need wallpaper image to `userContent.css`. :root { --uc-newTab-wallpaper: url("../icons/background_image.png"); }

// defaultPref("userContent.page.proton_color.dark_blue_accent", true);
// defaultPref("userContent.page.proton_color.system_accent",    true);
// defaultPref("userContent.page.dark_mode.pdf",                 true);
// defaultPref("userContent.page.monospace",                     true);

// == Theme Default Settings ===================================================
// -- User Chrome --------------------------------------------------------------
defaultPref("userChrome.compatibility.theme", true);
defaultPref("userChrome.compatibility.os", true);

defaultPref("userChrome.theme.built_in_contrast", true);
defaultPref("userChrome.theme.system_default", true);
defaultPref("userChrome.theme.proton_color", true);
defaultPref("userChrome.theme.proton_chrome", true); // Need proton_color
defaultPref("userChrome.theme.fully_color", true); // Need proton_color
defaultPref("userChrome.theme.fully_dark", true); // Need proton_color

defaultPref("userChrome.decoration.cursor", true);
defaultPref("userChrome.decoration.field_border", true);
defaultPref("userChrome.decoration.download_panel", true);
defaultPref("userChrome.decoration.animate", true);

defaultPref("userChrome.padding.tabbar_width", true);
defaultPref("userChrome.padding.tabbar_height", true);
defaultPref("userChrome.padding.toolbar_button", true);
defaultPref("userChrome.padding.navbar_width", true);
defaultPref("userChrome.padding.urlbar", true);
defaultPref("userChrome.padding.bookmarkbar", true);
defaultPref("userChrome.padding.infobar", true);
defaultPref("userChrome.padding.menu", true);
defaultPref("userChrome.padding.bookmark_menu", true);
defaultPref("userChrome.padding.global_menubar", true);
defaultPref("userChrome.padding.panel", true);
defaultPref("userChrome.padding.popup_panel", true);

defaultPref("userChrome.tab.multi_selected", true);
defaultPref("userChrome.tab.unloaded", true);
defaultPref("userChrome.tab.letters_cleary", true);
defaultPref("userChrome.tab.close_button_at_hover", true);
defaultPref("userChrome.tab.sound_hide_label", true);
defaultPref("userChrome.tab.sound_with_favicons", true);
defaultPref("userChrome.tab.pip", true);
defaultPref("userChrome.tab.container", true);
defaultPref("userChrome.tab.crashed", true);

defaultPref("userChrome.fullscreen.overlap", true);
defaultPref("userChrome.fullscreen.show_bookmarkbar", true);

defaultPref("userChrome.icon.library", true);
defaultPref("userChrome.icon.panel", true);
defaultPref("userChrome.icon.menu", true);
defaultPref("userChrome.icon.context_menu", true);
defaultPref("userChrome.icon.global_menu", true);
defaultPref("userChrome.icon.global_menubar", true);
defaultPref("userChrome.icon.1-25px_stroke", true);

// -- User Content -------------------------------------------------------------
defaultPref("userContent.player.ui", true);
defaultPref("userContent.player.icon", true);
defaultPref("userContent.player.noaudio", true);
defaultPref("userContent.player.size", true);
defaultPref("userContent.player.click_to_play", true);
defaultPref("userContent.player.animate", true);

defaultPref("userContent.newTab.full_icon", true);
defaultPref("userContent.newTab.animate", true);
defaultPref("userContent.newTab.pocket_to_last", true);
defaultPref("userContent.newTab.searchbar", true);

defaultPref("userContent.page.field_border", true);
defaultPref("userContent.page.illustration", true);
defaultPref("userContent.page.proton_color", true);
defaultPref("userContent.page.dark_mode", true); // Need proton_color
defaultPref("userContent.page.proton", true); // Need proton_color

lockPref("browser.phoenix.status.ui-fix", "successfully applied :D");
